chapter 3 here. modifyed